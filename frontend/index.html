<!DOCTYPE html>
<html>
  <head>
    <title>ESP Web Server</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  </head>
  <body>
    <div>
      Current Force(Internal Units): <span id="scale">0</span> Current
      Force(Calibrated Scale): <span id="scale_cal">0</span>
      <button id="zero">Zero Scale</button>
    </div>
    <div>
      <input type="text" placeholder="Calibration Scale" />
      <button>Calibrate</button>
    </div>
    <script>
      var gateway = `ws://192.168.1.6/ws`;
      var websocket;
      window.addEventListener("load", onLoad);
      function initWebSocket() {
        console.log("Trying to open a WebSocket connection...");
        websocket = new WebSocket(gateway);
        websocket.onopen = onOpen;
        websocket.onclose = onClose;
        websocket.onmessage = onMessage;
      }
      function onOpen(event) {
        console.log("Connection opened");
      }
      function onClose(event) {
        console.log("Connection closed");
        setTimeout(initWebSocket, 2000);
      }
      function onMessage(event) {
        document.getElementById("scale").innerHTML = event.data;
      }
      function onLoad(event) {
        initWebSocket();
        initButton();
      }
      function initButton() {
        document.getElementById("zero").addEventListener("click", zero);
      }
      function zero() {
        websocket.send("zero");
      }
    </script>
  </body>
</html>
